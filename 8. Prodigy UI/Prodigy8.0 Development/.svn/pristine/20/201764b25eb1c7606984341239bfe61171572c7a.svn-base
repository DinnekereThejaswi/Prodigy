<div class="row">
    <div class="col-sm-8">

    </div>
    <div class="col-sm-4">
        <app-lastdocno [routerUrl]="routerUrl" style="color: brown; text-align: right; font-style: italic;">
        </app-lastdocno>
    </div>
</div>
<div class="col-md-12">
    <div class="card">
        <div class="card-body">
            <form class="form-horizontal">
                <div class="row">
                    <div class="col-sm-4">
                        <div class="form-group">
                            <label class="control-label" for="no">Received From</label>
                            <select class="form-control" (change)="getAllIssueNo($event)"
                                [(ngModel)]="opgMeltingReceiptPost.ReceiptFrom" [ngModelOptions]="{standalone: true}">
                                <option [ngValue]="null">Select</option>
                                <option *ngFor="let _from of receiptfrom" [value]="_from.Code">
                                    {{_from.Name}}
                                </option>
                            </select>
                        </div>
                    </div>
                    <div class="col-sm-4">
                        <div class="form-group">
                            <label class="control-label" for="no">Melting Issue No </label>
                            <select class="form-control" (change)="getMletingReceiptDetails($event)"
                                [(ngModel)]="opgMeltingReceiptPost.IssueNo" [ngModelOptions]="{standalone: true}">
                                <option [ngValue]="null">Select</option>
                                <option *ngFor="let _IssueNumbers of IssueNumbers" [value]="_IssueNumbers.Code">
                                    {{_IssueNumbers.Name}}
                                </option>
                            </select>
                        </div>

                    </div>
                    <div class="col-sm-4">
                        <div class="form-group">
                            <label class="control-label" for="no">Recevied By</label>
                            <input class="form-control" type="text" value="Admin" readonly>
                        </div>
                    </div>

                </div>
                <div class="row">
                    <div class="col-sm-4">
                        <div class="form-group">
                            <label class="control-label" for="no">Date</label>
                            <input type="text" class="form-control" bsDatepicker [bsConfig]="datePickerConfig" readonly
                                value="{{applicationDate  }}" />
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <div class="form-group">
                            <div class="form-group">
                                <label class="control-label" for="no">Remarks </label>
                                <input class="form-control" type="text" [(ngModel)]="opgMeltingReceiptPost.Remarks"
                                    [ngModelOptions]="{standalone: true}" placeholder="Please Enter Remarks">
                            </div>
                        </div>
                    </div>
                </div>
            </form>
        </div>
        <ng-container *ngIf="EnableJson">
            <div class="col-md-3">
                <pre>{{opgMeltingReceiptPost | json}}</pre>
            </div>
        </ng-container>
    </div>
</div>
<br>




<div id="accordian" class="accordion">
    <div class="card mb-0">
        <div class="card-header Pointer" href="#itemDetails" (click)="ToggleitemDetails()"
            [ngClass]="EnableItemDetails ? 'collapsed' : ''" [attr.data-toggle]="EnableItemDetails ? '':'collapse'"
            style="background-color: #fdfdfd; box-shadow: -1px 0px 2px 0px rgba(0, 0, 0, 0.36);color:black">
            <div class="row">
                <div class="col-md-2 ">
                    <a class="card-title align-middle" style="color:#005BFF">
                        <i class="fal fa-hand-receiving fa-2x mr-2 align-middle"></i>
                        <span class="align-middle Pointer"><ins>ItemDetails</ins></span>
                    </a>
                </div>
            </div>
        </div>
        <div id="itemDetails" class="card-body collapse" [collapse]="EnableItemDetails">
            <div class="row">
                <div class="col-md-12">
                    <div class="table-responsive">
                        <table class="table table-bordered" style="width: 1300px;">
                            <thead class="topbar">
                                <tr>
                                    <th>HSN</th>
                                    <th>Batch Id</th>
                                    <th>Issue Wt</th>
                                    <th>GS</th>
                                    <th>Received Wt</th>
                                    <th>Kova Wt</th>
                                    <th>M Loss</th>
                                    <th>Rate /Gram</th>
                                    <th>Amount</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody *ngFor="let _items of MeltingReceiptItems; let i = index">
                                <tr>
                                    <td></td>
                                    <td>{{_items.BatchId}}</td>
                                    <td>{{_items.GrossWt}}</td>
                                    <td>{{_items.GSCode}}</td>
                                    <td>{{_items.NetWt}}</td>
                                    <td>{{_items.AlloyWt }}</td>
                                    <td>{{_items.WastageWt}}</td>
                                    <td>{{_items.Rate}}</td>
                                    <td>{{_items.Amount}}</td>
                                    <td>
                                        <button
                                            class="btn waves-effect waves-light btn-rounded btn-outline-secondary pull-right"
                                            (click)="edit(_items,i)" [disabled]="disabledEditbutton">
                                            <i class="fal fa-pencil-alt"></i> Edit</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>


            <div class="row" *ngIf="fieldArray.length > '0'">
                <div class=" col-md-12">
                    <div class="table-responsive">
                        <table class="table table-bordered" style="width: 1300px;">
                            <thead class="topbar">
                                <tr>
                                    <th>Batch Id</th>
                                    <th>Issue Wt</th>
                                    <th>GS</th>
                                    <th>Received Wt</th>
                                    <th>Kova Wt</th>
                                    <th>M Loss</th>
                                    <th>Rate /Gram</th>
                                    <th>Amount</th>
                                    <th>Action</th>

                                </tr>
                            </thead>
                            <tbody *ngFor="let field of fieldArray; let i = index">
                                <tr>
                                    <td>
                                        <input class="form-control CustomWidth150" type="text"
                                            [(ngModel)]="field.BatchId" readonly>
                                    </td>
                                    <td>
                                        <input class="form-control CustomWidth75" type="text"
                                            [(ngModel)]="field.GrossWt" readonly>
                                    </td>
                                    <td>
                                        <select class="form-control mr-auto mt-2 mt-lg-0 CustomWidth100"
                                            [(ngModel)]="field.GSCode">
                                            <option [ngValue]="null" [disabled]="readonly[i]">Select
                                            </option>
                                            <option *ngFor="let _Gs of GsList" [value]="_Gs.Code"
                                                [disabled]="readonly[i]">
                                                {{_Gs.Name}} </option>
                                        </select>
                                    </td>
                                    <td>
                                        <input class="form-control CustomWidth100" type="text" [(ngModel)]="field.NetWt"
                                            type='number' step='0.01' value='0.00' placeholder='0.00' autocomplete="off"
                                            [readonly]="readonly[i]" BlueBorder (change)="CalculateNetweight(i)">
                                    </td>
                                    <td>
                                        <input class="form-control CustomWidth100" type="text"
                                            [(ngModel)]="field.AlloyWt" [readonly]="readonly[i]" type='number'
                                            step='0.01' value='0.00' placeholder='0.00' autocomplete="off"
                                            appNumbersOnly (change)="calculateKovaWeight(i)" BlueBorder #kovweight>
                                    </td>
                                    <td>
                                        <input class="form-control CustomWidth100" type="text"
                                            [(ngModel)]="field.WastageWt" [readonly]="readonly[i]" type='number'
                                            step='0.01' value='0.00' placeholder='0.00' autocomplete="off">
                                    </td>
                                    <td>
                                        <input class="form-control CustomWidth100" type="text" [(ngModel)]="field.Rate"
                                            [readonly]="readonly[i]" (change)="calcAmount(i)" appNumbersOnly
                                            type='number' step='0.01' value='0.00' placeholder='0.00'
                                            autocomplete="off">
                                    </td>
                                    <td>
                                        <input class="form-control CustomWidth100" type="text"
                                            [(ngModel)]="field.Amount" [readonly]="readonly[i]" type='number'
                                            step='0.01' value='0.00' placeholder='0.00' autocomplete="off">
                                    </td>
                                    <td colspan="2">
                                        <ng-container *ngIf="EnableEditDelbtn[i]">
                                            <button class="btn btn-default btn-rounded wd" type="button"
                                                (click)="editFieldValue(i)"><i class="fal fa-pencil-alt"></i>
                                                Edit</button>
                                            <button class="btn btn-danger btn-rounded" type="button"
                                                (click)="cancelDataFieldValue(i)"><i class="fal fa-trash-alt"></i>
                                                clear</button>
                                        </ng-container>
                                        <ng-container *ngIf="EnableSaveCnlbtn[i]">
                                            <button class="btn btn-success btn-rounded" type="button"
                                                (click)="saveDataFieldValue(field,i)"><i class="fal fa-save"></i>
                                                Save</button>
                                            <button class="btn btn-warning btn-rounded" type="button"
                                                (click)="cancelDataFieldValue(i)"><i class="far fa-window-close"></i>
                                                clear</button>
                                        </ng-container>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <ng-container *ngIf="EnableJson">
                        <div class="col-md-3">
                            <pre>{{fieldArray | json}}</pre>
                        </div>
                    </ng-container>
                </div>
            </div>
        </div>
    </div>
</div>

<br>
<div class="row" *ngIf="MeltingReceiptItems.length > '0'">
    <div class="col-md-4">
        <button class="btn btn-outline-success waves-effect waves-light btn-rounded btn-outline-secondary "
            (click)="SaveMeltingReceipt()">
            <i class="far fa-save"></i> Submit</button>
        <button class="btn btn-danger waves-effect waves-light btn-rounded btn-secondary" (click)="cancel()"
            type="button"><i class="far fa-window-close"></i>&nbsp;Cancel</button>
    </div>
</div>


<div class="row" style="display:block;margin: auto;width: 30%;">
    <div class="modal fade" id="MeltingReceiptTab" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
        aria-hidden="true">
        <div class="modal-dialog modal-lg" role="document" style="max-width: 1400px">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button"
                        class="btn btn-outline-success waves-effect waves-light btn-rounded btn-outline-secondary"
                        id="exampleModalLabel" (click)=print()><i class="fal fa-print"></i> Print</button>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close" (click)="cancel()">
                            <span aria-hidden="true">&times;</span>
                          </button>
                </div>
                <div id="DisplayntReceiptData" class="center" [innerHTML]='meltingreceiptPrintData | safeHtml'>

                </div>
            </div>
        </div>
    </div>