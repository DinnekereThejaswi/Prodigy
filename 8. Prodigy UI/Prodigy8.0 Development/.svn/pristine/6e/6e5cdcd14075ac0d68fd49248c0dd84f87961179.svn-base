<div id="header" class="show">
  <form [formGroup]="SRHeaderForm" class="form-horizontal">
    <div class="row">
      <div class="col-lg-12">
        <div class="form-body">
          <div class="row">
            <div class="col-md-3">
              <div class="form-group">
                <label class="control-label"></label>
                <div class="m-b-10">
                  <label *ngFor="let radiobutton of radioItems" class="custom-control custom-radio align-middle"
                    style="display: inline-block;padding-right: 1.5rem;">
                    <input type="radio" class="custom-control-input" [value]="radiobutton" formControlName="BranchType"
                      [(ngModel)]="ItemDetails.BranchType" (click)="OnRadioBtnChnge(radiobutton)"
                      [checked]="radiobutton === model.option">
                    <span class="custom-control-label">{{radiobutton}}</span>
                  </label>
                </div>
              </div>
            </div>
            <!--/span-->
            <div class="col-md-3">
              <div class="form-group">
                <label class="control-label">Billed Branch</label>
                <select class="form-control mr-auto mt-2 mt-lg-0" formControlName="BilledBranch"
                  [(ngModel)]="SalesReturnHeaderDetails.BilledBranch">
                  <option [ngValue]="null">Select</option>
                  <option *ngFor="let _BilledBranch of BilledBranch" [value]="_BilledBranch.PartyCode">
                    {{_BilledBranch.PartyName}}
                  </option>
                </select>
              </div>
            </div>
            <div class="col-md-3">
              <div class="form-group">
                <label class="control-label">Select Sales Person</label>
                <select class="form-control mr-auto mt-2 mt-lg-0" formControlName="SalCode"
                  [(ngModel)]="SalesReturnHeaderDetails.SalCode">
                  <option [ngValue]="null">Select</option>
                  <option *ngFor="let _salesman of SalesManList" [value]="_salesman.sal_code">
                    {{_salesman.CodeName}}
                  </option>
                </select>
              </div>
            </div>
            <!-- <div class="col-md-3">
              <div class="text-left"><i class="fal fa-calendar-alt"></i>&nbsp; <span class="text-muted">Sales
                  Date</span>
                <h1 class="font-light" formControlName="SalesDate" ngDefaultControl
                  [(ngModel)]="SalesReturnHeaderDetails.SalesDate">{{salesDate}}</h1>
              </div>
            </div> -->
            <div class="col-md-3">
              <div class="form-group">
                <label class="control-label">Remarks</label>
                <div class="m-b-10">
                  <input type="text" class="form-control" formControlName="Remarks"
                    [(ngModel)]="SalesReturnHeaderDetails.Remarks">
                </div>
              </div>
            </div>
          </div>
          <!--/span-->
        </div>
      </div>
    </div>
    <!-- <pre>{{ SRHeaderForm | json }}</pre> -->

    <div class="table-responsive">
      <table class="table table-bordered" id='panels'>
        <thead class="topbar">
          <tr>
            <th>Action</th>
            <th></th>
            <th>SL No</th>
            <th>S.Code</th>
            <th>Item</th>
            <th>Qty</th>
            <th>Gr. Wt</th>
            <th>Nt.Wt</th>
            <th>AddWt</th>
            <th>Deduct Wt</th>
            <th>Item Amount</th>
            <th>Final Item</th>
          </tr>
        </thead>
        <tbody *ngFor="let field of fieldArray; let i = index">
          <tr>
            <td>
              <input type="checkbox" name="fieldCheckbox" [id]="fieldCheckbox + i"
                (change)="AppendItemDataRow(field,i,$event)">
            </td>
            <td>
              <button data-toggle="collapse" [attr.data-target]="'#item'+ i" aria-hidden="true"
                (click)="getStoneDiamDetails(field.lstOfStoneDetails,i)">Fitted Diamond/Stone</button>
            </td>
            <!-- (click)="sendDataToDiamondComp(field,i)" -->
            <td>{{field.SlNo}}</td>
            <td>{{field.SalCode}}</td>
            <td>{{field.ItemName}}</td>
            <td>{{field.Quantity}}</td>
            <td>{{field.GrossWt}}</td>
            <td>{{field.NetWt}}</td>
            <td>{{field.AddWt}}</td>
            <td>{{field.DeductWt}}</td>
            <td>{{field.ItemTotalAfterDiscount}}</td>
            <td>{{field.ItemFinalAmount}}</td>
          </tr>
          <tr>
            <td colspan="14" class="hiddenRow" *ngIf="field.lstOfStoneDetails.length >0">
              <div class="collapse wrapper" id="item{{i}}" data-parent="#panels">
                <fieldset class="scheduler-border">
                  <legend class="scheduler-border"><i class="fas fa-gem align-middle"></i> Fitted Diamond/Stone</legend>
                  <div class="table-responsive">
                    <table class="table">
                      <thead class="topbar">
                        <tr>
                          <th>SL No</th>
                          <th>Name</th>
                          <th>Quantity</th>
                          <th>Carat</th>
                          <th>Rate/Carat</th>
                          <th>Amount</th>
                        </tr>
                      </thead>
                      <tbody *ngFor="let _stoneDiamond of field.lstOfStoneDetails; let i = index">
                        <tr>
                          <td>{{_stoneDiamond.Sno}}</td>
                          <td>{{_stoneDiamond.Name}}</td>
                          <td>{{_stoneDiamond.Qty}}</td>
                          <td>{{_stoneDiamond.Carrat}}</td>
                          <td>{{_stoneDiamond.Rate}}</td>
                          <td>{{_stoneDiamond.Amount}}</td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </fieldset>
              </div>
            </td>
          </tr>
        </tbody>
        <tr style=" border: none;">
          <td class="border-none"></td>
          <td class="border-none"></td>
          <td class="border-none"></td>
          <td class="border-none"></td>
          <td class="border-none"><span class="Heading">Grand Total</span>:</td>
          <td class="border-none">{{Qty(fieldArray)}}</td>
          <td class="border-none">{{GrossWtTotal(fieldArray) | number : '1.3-3'}}</td>
          <td class="border-none">{{NetWt(fieldArray) | number : '1.3-3'}}</td>
          <td class="border-none">{{AddWt(fieldArray) | number : '1.3-3'}}</td>
          <td class="border-none">{{DedWt(fieldArray) | number : '1.3-3'}}</td>
          <td class="border-none"></td>
          <td class="border-none">{{Amount(fieldArray) | number : '1.2-2'}}</td>
        </tr>
      </table>
    </div>
    <div class="row pt-2 pb-3">
      <div class="col-md-4">
        <button class="btn btn-outline-success waves-effect waves-light btn-rounded btn-outline-secondary "
          (click)="submitPost(SRHeaderForm)">Submit</button>
      </div>
    </div>
  </form>
</div>


<ng-container *ngIf="EnableJson">
  <pre>{{SalesReturnHeaderDetails | json}}</pre>
</ng-container>

<!-- <pre>{{SelectedItemLines | json}}</pre> -->
<div class="row">
  <div class="col-lg-5 col-md-5">
    <div class="card">
      <div class="row">
        <div class="col-12">
          <div class="social-widget">
            <div class="soc-header box-facebook">
              <h3 class="text-white">Payable Amount</h3>
            </div>
            <div class="soc-content">
              <div class="col-4 b-r">
                <h4 class="font-medium">{{totalFinalAmt || "0.00" | number : '1.2-2'}}</h4>
                <h5 class="text-black">Total SR Amt.
                  <h1 class="float-right">-</h1>
                </h5>
              </div>
              <div class="col-4 b-r">
                <h4 class="font-medium">{{vpAmt || "0.00" | number : '1.2-2'}}</h4>
                <h5 class="text-black">VP Amt
                  <h1 class="float-right">=</h1>
                </h5>
              </div>
              <div class="col-4 b-r">
                <h4 class="font-medium">{{payableAmt || "0.00" | number : '1.2-2'}}</h4>
                <h5 class="text-black">Payable Amt</h5>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- Column -->

  <!-- Column -->
  <div class="col-lg-7 col-md-7">
    <div class="card">
      <div class="row">
        <div class="col-12">
          <div class="social-widget">
            <div class="soc-header box-facebook">
              <h3 class="text-white">Amount Details</h3>
            </div>
            <div class="soc-content">
              <div class="col-3 b-r">
                <h4 class="font-medium">{{totalAmtafterDiscount || "0.00" | number : '1.2-2'}}</h4>
                <h5 class="text-black">Total Amt<h1 class="float-right">+</h1>
                </h5>
              </div>
              <div class="col-2 b-r">
                <h4 class="font-medium">{{GST || "0.00" | number : '1.2-2'}}</h4>
                <h5 class="text-black">Sales GST<h1 class="float-right">+</h1>
                </h5>
              </div>
              <div class="col-2 b-r">
                <h4 class="font-medium">{{"0.00" | number : '1.2-2'}}</h4>
                <h5 class="text-black">Cess Amt
                  <ng-conatiner *ngIf="roundOff >= 0 || roundOff >= 0.00">
                    <h1 class="float-right">+</h1>
                  </ng-conatiner>
                  <ng-conatiner *ngIf="roundOff < 0">
                    <h1 class="float-right">-</h1>
                  </ng-conatiner>
                </h5>
              </div>
              <div class="col-2 b-r">
                <h4 class="font-medium">{{roundOffValue || "0.00" | number : '1.2-2'}}</h4>
                <h5 class="text-black">Round Off<h1 class="float-right">=</h1>
                </h5>
              </div>
              <div class="col-3 b-r">
                <h4 class="font-medium">{{totalFinalAmt || "0.00" | number : '1.2-2'}}</h4>
                <h5 class="text-black">Total SR Amt</h5>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<br>
<span style="color: red;">Note : All weights are in Grams</span>